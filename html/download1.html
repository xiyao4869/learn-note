<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>下载图片</title>
  </head>
  <body>
    <!-- https://mp.weixin.qq.com/s/Ro5FFkCa-7XxIHfRp2XRDA -->
    <script>
      // 通过src获取图片的blob对象

      function getImageBlob(url, cb) {
        var xhr = new XMLHttpRequest();

        xhr.open('get', url, true);

        xhr.responseType = 'blob';

        xhr.onload = function() {
          if (this.status == 200) {
            cb(this.response);
          }
        };

        xhr.send();
      }

      getImageBlob(
        'https://cdn.segmentfault.com/v-5c4ec07f/global/img/user-64.png',
        function(blob) {
          // 生成下载用的URL对象

          let url = URL.createObjectURL(blob);

          // 生成一个a标签，并模拟点击，即可下载，批量下载同理

          let aDom = document.createElement('a');

          aDom.href = url;

          aDom.download = 'a.png';

          aDom.text = '下载文件';

          document.body.appendChild(aDom);

          // aDom.click();
        }
      );
    </script>
  </body>
</html>
